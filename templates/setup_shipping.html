
{% extends "base.html" %}

{% block title %}Pengaturan Pengiriman - {{ receipt.receipt_number }}{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-shipping-fast me-2"></i>
                        Pengaturan Pengiriman - {{ receipt.receipt_number }}
                    </h5>
                </div>
                
                <div class="card-body">
                    <!-- Transaction Summary -->
                    <div class="alert alert-success">
                        <h6><i class="fas fa-handshake me-2"></i>Detail Transaksi</h6>
                        <strong>Anda akan mengirim:</strong> {{ receipt.main_item_offered }}<br>
                        <strong>Untuk mendapat:</strong> {{ receipt.main_item_wanted }}<br>
                        {% if receipt.additional_items_detail %}
                        <strong>Plus tambahan:</strong> {{ receipt.additional_items_detail }}
                        {% endif %}
                    </div>
                    
                    <form method="POST">
                        <div class="row">
                            <!-- Sender Information -->
                            <div class="col-md-6 mb-4">
                                <h6 class="text-primary"><i class="fas fa-user me-2"></i>Data Pengirim (Anda)</h6>
                                
                                <div class="mb-3">
                                    <label class="form-label">Alamat Lengkap Pengirim</label>
                                    <textarea name="sender_address" class="form-control" rows="3" required 
                                              placeholder="Jl. Contoh No. 123, RT/RW 01/02, Kelurahan, Kecamatan, Kota, Kode Pos"></textarea>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">No. Telepon Pengirim</label>
                                    <input type="tel" name="sender_phone" class="form-control" 
                                           placeholder="08123456789" value="{{ current_user.phone or '' }}" required>
                                </div>
                            </div>
                            
                            <!-- Receiver Information -->
                            <div class="col-md-6 mb-4">
                                <h6 class="text-success"><i class="fas fa-map-marker-alt me-2"></i>Data Penerima</h6>
                                
                                <div class="mb-3">
                                    <label class="form-label">Alamat Lengkap Penerima</label>
                                    <textarea name="receiver_address" class="form-control" rows="3" required 
                                              placeholder="Alamat lengkap penjual"></textarea>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">No. Telepon Penerima</label>
                                    <input type="tel" name="receiver_phone" class="form-control" 
                                           placeholder="08123456789" value="{{ receipt.proposal.proposal_receiver.phone or '' }}" required>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Package Information -->
                        <div class="card border-warning mb-4">
                            <div class="card-header bg-warning bg-opacity-25">
                                <h6 class="mb-0"><i class="fas fa-box me-2"></i>Informasi Paket</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label">Berat Paket (kg)</label>
                                        <input type="number" name="package_weight" class="form-control" 
                                               min="0.1" step="0.1" placeholder="1.5" required>
                                    </div>
                                    
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label">Dimensi (cm)</label>
                                        <input type="text" name="package_dimensions" class="form-control" 
                                               placeholder="30x20x10">
                                    </div>
                                    
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label">Nilai Asuransi (Rp)</label>
                                        <input type="number" name="insurance_value" class="form-control" 
                                               min="0" step="1000" placeholder="100000">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Courier Selection -->
                        <div class="card border-info mb-4">
                            <div class="card-header bg-info bg-opacity-25">
                                <h6 class="mb-0"><i class="fas fa-truck me-2"></i>Pilihan Kurir</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Kurir</label>
                                        <select name="courier_service" class="form-select" required>
                                            <option value="">Pilih Kurir</option>
                                            <option value="JNE">JNE</option>
                                            <option value="J&T">J&T Express</option>
                                            <option value="TIKI">TIKI</option>
                                            <option value="POS">Pos Indonesia</option>
                                            <option value="SICEPAT">SiCepat</option>
                                            <option value="ANTERAJA">AnterAja</option>
                                            <option value="LION">Lion Parcel</option>
                                        </select>
                                    </div>
                                    
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Jenis Layanan</label>
                                        <select name="service_type" class="form-select" required>
                                            <option value="">Pilih Layanan</option>
                                            <option value="REG">Regular</option>
                                            <option value="YES">YES (1 hari)</option>
                                            <option value="OKE">OKE (2-3 hari)</option>
                                            <option value="CARGO">Cargo</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Biaya Ongkir (Rp)</label>
                                        <input type="number" name="shipping_cost" class="form-control" 
                                               min="0" step="1000" placeholder="25000" required>
                                        <small class="text-muted">Cek tarif di website/aplikasi kurir</small>
                                    </div>
                                    
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Estimasi Pengiriman (hari)</label>
                                        <input type="number" name="estimated_delivery" class="form-control" 
                                               min="1" max="14" placeholder="3" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Important Note -->
                        <div class="alert alert-warning">
                            <h6><i class="fas fa-exclamation-triangle me-2"></i>Penting!</h6>
                            <ul class="mb-0">
                                <li>Sebagai pembeli, Anda bertanggung jawab atas biaya pengiriman</li>
                                <li>Pastikan barang dikemas dengan baik dan aman</li>
                                <li>Simpan struk/bukti pengiriman hingga transaksi selesai</li>
                                <li>Update nomor resi setelah pengiriman dilakukan</li>
                            </ul>
                        </div>
                        
                        <div class="text-center">
                            <button type="submit" class="btn btn-success btn-lg me-3">
                                <i class="fas fa-check me-2"></i>Konfirmasi Pengaturan Pengiriman
                            </button>
                            <a href="{{ url_for('transaction_receipt', receipt_id=receipt.id) }}" class="btn btn-secondary">
                                <i class="fas fa-arrow-left me-2"></i>Kembali
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
